<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Nebula Graph"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@NebulaGraph"><meta name=twitter:creator content="@NebulaGraph"><meta name=twitter:domain content="nebula-graph.io"><meta name=twitter:title content="How Nebula Graph Uses Jepsen to Detect Data Consistency Issues in Raft Implementation"><meta property="twitter:title" content="How Nebula Graph Uses Jepsen to Detect Data Consistency Issues in Raft Implementation"><meta name=twitter:description content="In this post, we will explain how to verify data consistency of the distributed Nebula Graph kv stores with the Jepsen test framework."><meta name=og:description content="In this post, we will explain how to verify data consistency of the distributed Nebula Graph kv stores with the Jepsen test framework."><meta name=twitter:image content="/nebula-website/en/posts/detect-data-consistency-issues-in-raft-implementing-with-jepsen/_hu8aadb18101d956a60f9323fcd07c446c_656687_c1bdd60fc29cd45fb66226e211a79e2f.png"><meta name=og:image content="/nebula-website/en/posts/detect-data-consistency-issues-in-raft-implementing-with-jepsen/_hu8aadb18101d956a60f9323fcd07c446c_656687_c1bdd60fc29cd45fb66226e211a79e2f.png"><meta name=description content="In this post, we will explain how to verify data consistency of the distributed Nebula Graph kv stores with the Jepsen test framework."><meta name=generator content="Hugo 0.65.3"><title>How Nebula Graph Uses Jepsen to Detect Data Consistency Issues in Raft Implementation</title><link rel="shortcut icon" href=/nebula-website/favicon.ico><link rel=stylesheet href=/nebula-website/css/bootstrap.min.css type=text/css><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic" rel=stylesheet type=text/css><link rel=stylesheet href=/nebula-website/font-awesome/css/font-awesome.min.css type=text/css><link rel=stylesheet href=/nebula-website/css/creative.css type=text/css><link rel=stylesheet href=/nebula-website/css/modals.css type=text/css><link rel=stylesheet href=/nebula-website/css/animate.min.css type=text/css><link rel=stylesheet href=/nebula-website/css/custom/index.css type=text/css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/nebula-website/js/jquery.js></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPJVFGH');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-60523578-5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-60523578-5');</script></head><body id=page-top><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PPJVFGH" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><nav id=mainNav class="navbar navbar-default navbar-fixed-top"><div class=nav-popup id=nav-popup><img src=/images/popup.png><img src=/images/popup.png> Nebula Graph RC4 is released! <a href=https://github.com/vesoft-inc/nebula/releases/tag/v1.0.0-rc4 target=_blank>Get Started</a> <img src=/images/shut.png id=shut onclick=shut()></div><div class=container-fluid><div class=navbar-header><div class=github-star onclick="gtag('event','Link Click',{event_category:'Engagement',event_label:'Star via Navi'})"><a class=github-button href=https://github.com/vesoft-inc/nebula data-icon=octicon-star data-show-count=true aria-label="Star vesoft-inc/nebula on GitHub">Star</a></div><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class="navbar-brand page-scroll" href=/nebula-website/en/></a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav" id=nav><li class=github-star id=github-star onclick="gtag('event','Link Click',{event_category:'Engagement',event_label:'Star via Navi'})"><a class=github-button href=https://github.com/vesoft-inc/nebula data-size=large data-show-count=true aria-label="Star vesoft-inc/nebula on GitHub">Star</a></li><li><a href=https://docs.nebula-graph.io/ target=_blank>Docs</a></li><li class=active><a href=/en/posts target>Blog</a></li><li><a href=https://discuss.nebula-graph.io/ target=_blank>Forum</a></li><li><a href=#contact_us target onclick=contactUsClick()>Contact Us</a></li><li class="dropdown navbar-right"><a class=dropdown-toggle data-toggle=dropdown href=# role=button aria-haspopup=true aria-expanded=false><img src=/images/language120x120.png>
<span class=caret></span></a><ul class=dropdown-menu><li class=nav-item><a class=dropdown-item href=/en target>English</a></li><li class=nav-item><a class=dropdown-item href=/cn target>中文</a></li></ul></li><li id=navbar-right><a href=https://github.com/vesoft-inc/nebula-web-docker target=_blank onclick="gtag('event','Button Click',{event_category:'Engagement',event_label:'Nebula Studio'})">Nebula Studio</a></li></ul></div></div></nav><script>function contactUsClick(){$('html,body').animate({scrollTop:document.documentElement.scrollHeight},800)
return false;}
function shut(){$('#nav-popup').remove();$("#top").css("padding-top","50px")
sessionStorage.setItem("popupIsRemove",true);}
if(!sessionStorage.getItem("popupIsRemove")){$("#nav-popup").css("display","block")}</script><main id=top class=blog-detail><div class=wrapper><div class=inner><div class=blog-left-aside><div class=social-share id=J_Share><h3>Share</h3><div class=nebula-share-buttons><div class="st-custom-button st-remove-label" data-network=twitter><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/twitter-white.svg></div><div class="st-custom-button st-remove-label" data-network=linkedin><img alt="linkedin-white sharing button" src=https://platform-cdn.sharethis.com/img/linkedin-white.svg></div><div class="st-custom-button st-remove-label" data-network=facebook><img alt="facebook-white sharing button" src=https://platform-cdn.sharethis.com/img/facebook-white.svg></div><div class="st-custom-button st-remove-label" data-network=hackernews><img alt="hackernews-white sharing button" src=https://platform-cdn.sharethis.com/img/hackernews-white.svg></div><div class="st-custom-button st-remove-label" data-network=reddit><img alt="reddit-white sharing button" src=https://platform-cdn.sharethis.com/img/reddit-white.svg></div><div class="st-custom-button st-remove-label" data-network=sharethis><img alt="reddit-white sharing button" src=https://platform-cdn.sharethis.com/img/sharethis-white.svg></div></div></div></div><section class=blog-content><h1>How Nebula Graph Uses Jepsen to Detect Data Consistency Issues in Raft Implementation</h1><div class=blog-metas><div class=meta><img src=/images/writer.png width=16px height=16px>
<span>critical27</span></div><div class=meta><img src=/images/calendar.png width=16px height=16px>
<span>2020-04-14</span></div><div class="tags meta"><img src=/images/tag.png width=16px height=16px>
<a href=/nebula-website/en//tags/dev-log>dev-log</a><a href=/nebula-website/en//tags/features>features</a></div></div><p><img src=https://user-images.githubusercontent.com/57335825/79218578-3b5d3080-7e83-11ea-9b39-82a6ecb5dffb.png alt="How Nebula Graph Uses Jepsen to Detect Data Consistency Issues in Raft Implementing"></p><p>Data consistency is a global issue for all distributed systems. Nebula Graph is no execption as a distributed graph database.
Thanks to the separation between query and storage layers, Nebula Graph only exposes simple kv interfaces in the storage layer. Using RocksDB as a backend kv library, Nebula Graph <a href=https://nebula-graph.io/en/posts/nebula-graph-storage-engine-overview/>ensures strong data consistency</a> among multiple replicas via the Raft protocol.
Although Raft is easier to understand than Paxos, implenting the protocol in a distributed system is another story which requires patience and practice.
In addition to the data consistency issue, how to test a Raft-based distributed system is a disturbing problem too. Currently, Nebula Graph verifies data consistency with Jepsen. In our previous post <a href=https://nebula-graph.io/en/posts/practice-jepsen-test-framework-in-nebula-graph/>Practice Jepsen Test Framework in Nebula Graph</a>, we have introduced in detail how Jepsen test framework works, you may take a look at it to gain some basic understanding about Jepsen.
In this post, we will explain how to verify data consistency of the distributed Nebula Graph kv stores.</p><h2 id=strong-data-consistency-explained>Strong Data Consistency Explained</h2><p>Let&rsquo;s start with the definition of strong data consistency. Quote the book <a href="https://www.amazon.com/Designing-Data-Intensive-Applications-Reliable-Maintainable-ebook/dp/B06XPJML5D/ref=sr_1_1?dchild=1&keywords=Designing+Data-Intensive+Applications&qid=1586310740&sr=8-1"><em>Designing Data-Intensive Applications</em></a>_:_>_In a linearizable system, as soon as one client successfully completes a write, all clients reading from the database must be able to see the value just written._
The basic idea of strong data consistency or linearizability is to make a distributed system appear as if there were only one copy of the data, and all operations on it are atomic. Any read request from any client gets the latest data written to the system.</p><h2 id=linearizability-verification-with-jepsen>Linearizability Verification with Jepsen</h2><p>Take Jepsen timeline test as an example. In this test we use the <strong>single-register</strong> model. Clients can only perform read or write operations on the register. All operations are atomic and there is no intermediate state.
Suppose there are four clients sending requests to the system at the same time. Each bar in the figure indicates a request made by a client, where the top of a bar is the time when the request was sent, and the bottom of a bar is when the response was received by the client.
<img src=https://user-images.githubusercontent.com/57335825/79217801-043a4f80-7e82-11ea-85fc-a69c0518790d.png alt="jepsen test">
From the client&rsquo;s point of view, any request will be processed at anytime between the time when it was sent and the time when the response was received. Seen from the figure above, the three operations, write 1 by client 1 (i.e. 1: write1), write 4 by client 3 (i.e. 3: write4), and read 1 by client 4 (i.e. 4: read1), overlapped in processing time. However, we know the real request processing sequece by the system via the responses received by different clients.
Here&rsquo;s how:
The initial value is empty yet client 4 gets 1 for its read request, which indicates that the read operation by client 4 must have begun after the write 1 operation by client 1 and that write 4 by client 3 must have happened before write 1, or the older value 4 would be returned for the read request by client 4. Thus the sequential order of the three operations is write 4 -> write 1 -> read 1. Although seen from the above figure, request read 1 is sent first, it&rsquo;s the last one processed. Later operations do not overlap in time, that is to say they are sent sequentially. Read request by client 2 returns the last write value 4. The entire process does not violate the rules of strong data consistency, so the verification is passed.
If the read request by client 3 returns the older value 4, then the system is not strongly consistent. Based on the previous analysis, the last successful write value is 1. If client 3 gets the stale value 4, then linearlizability of the system is broken.
Actually Jepsen verifies strong data consistency of distributed systems with similar algorithms.</p><h2 id=data-consistency-issues-found-with-jepsen-test>Data Consistency Issues Found with Jepsen Test</h2><p>To better understand data consistency examples following, let&rsquo;s take a look at how a request is processed in a Raft group (three replicas) in Nebula Graph.
Read request processing is relatively simple because the clients only send the requests to the leader. Then the leader, after ensuring it&rsquo;s still the leader, just sends back the corresponding result from the state machine to the client.
Write request processing is a bit more complex. The steps are shown in the Raft Group Figure below:</p><ol><li>Leader (the green circle) receives requests sent from client and writes them into its wal (write ahead log).</li><li>Leader sends the corresponding log entry in the wal to its followers and enters the waiting phase.</li><li>Follower receives the log entry and writes it into its own wal,  then returns success.</li><li>When at least one follower returns success, leader updates the state machine and sends response to the client.</li></ol><p><img src=https://user-images.githubusercontent.com/57335825/79217666-cccba300-7e81-11ea-81ac-b55cd84cbfcc.png alt="Raft groups">
Now we will show you some Nebula Graph Raft implementing issues found in Jepsen test with examples below.</p><h3 id=data-consistency-example-1-stale-value-returned-for-read-requests>Data consistency example 1: Stale value returned for read requests </h3><p>Shown in the above figure, A, B, C forms a three-replica raft group. The circles are the state machines (we assume them as single-registers for simplicity) and the box stores the corresponding log entry.</p><ul><li>At the initial state, all the state machines in the three replicas are 1, the leader is A and the term is 1.</li><li>After request write 2 is sent by the client, leader processes it based on the previously described process, informs the client of a successful write, and is then killed.</li><li>Then C is elected as leader of term 2. However, since C has yet applied the log entry of write 2 to the state machine (the value is still 1 at the time being), 1 will be returned if C receives requests from client. This absolutely violates the definition of strong data consistency because 2 has been successfully written while a stale value is returned.</li></ul><p>Such issue appeares after C is elected as leader of term 2. It is necessary to send heartbeat to ensure the log entry of the previous term is accepted by quorum of the nodes. No read is allowed before the heartbeat success. Otherwise stale data is likely to be returned. Please refer to Figure 8 and Session 5.4.2 in this<a href=https://raft.github.io/raft.pdf> Raft paper</a> if you want more details.</p><h3 id=data-consistency-example-2-leader-ensures-itself-as-a-leader>Data consistency example 2: Leader ensures itself as a leader</h3><p>Another issue we have found via Jepsen test is: how does a leader ensure itself still the leader? Such problems occur upon network partition. When the old leader is isolated from other nodes due to network failure, if read is still allowed, a stale value is likely to be returned.
To avoid such cases, we have introduced the leader lease concept.
When a node is elected as leader, it needs to send heartbeats to other nodes periodically. If the heartbeat is received by most of the nodes successfully, a lease for some time is obtained and there will not be any new leaders during the term. Thus the data recency is guaranteed on the node and read requests are processed normally during this time.
<img src=https://user-images.githubusercontent.com/57335825/79217878-259b3b80-7e82-11ea-9e51-dbe929e11753.png alt=image>
Being different from TiKV&rsquo;s process, Nebula Graph doesn&rsquo;t consider _heartbeat interval * some coefficient _as the lease time because of the drift of the clock skew of different nodes.
Rather, we store 1) T1 = heartbeat intervals and 2) T2 = the time cost by the last successful heartbeat or appendLog, and get the lease duration by <em>(T2 - T1)</em>.
When network is partitioned, the old leader still processes read requests (write requests are failed due to the isolation) during the lease in spite of isolation. When the lease is expired, both read and write requests are failed. If no message is received for at least one heartbeat interval, followers will re-elect a new leader to process future client requests.</p><h2 id=conclusion>Conclusion</h2><p>You need long-term pressure tests and failure simulations to discover problems in a distributed system. Jespen is a great helper for its ability to verify distributed systems under various failures. In the future we will introduce other chaos engineering tools to verify data consistency in Nebula Graph. This way we can continuously improve performance while ensuring high data reliability.</p><blockquote><p>_Hi, I’m critical27, software engineer in Nebula Graph. Currently I am involved in the storage engine development. I hope this article is helpful and let me know if you have any thoughts and suggestions. Thanks!_</p></blockquote><h2 id=you-might-also-like>You might also like</h2><ul><li><a href=https://nebula-graph.io/en/posts/practice-jepsen-test-framework-in-nebula-graph/>Practice Jepsen Test Framework in Nebula Graph</a></li><li><a href=https://nebula-graph.io/en/posts/nebula-graph-storage-engine-overview/>An Introduction to Nebula Graph&rsquo;s Storage Engine</a></li></ul><blockquote class=star-ads><span>Like what we do ? Star us on GitHub.</span>
<a href=https://github.com/vesoft-inc/nebula onclick="gtag('event','Link Click',{event_category:'Engagement',event_label:'Star via blogbody'});">https://github.com/vesoft-inc/nebula</a></blockquote><ul class=blog-footer><li><img src=/images/tag.png>
<a href=/nebula-website/en/tags/dev-log>dev-log</a>
<a href=/nebula-website/en/tags/features>features</a></li><li class="nebula-share st-btn"><img src=/images/share.png>
<span>Share</span><ul class=blog-footer-share-links><li class=st-custom-button data-network=twitter><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/twitter-white.svg>
<span class=st-label>Twitter</span></li><li class=st-custom-button data-network=linkedin><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/linkedin-white.svg>
<span class=st-label>Linkedin</span></li><li class=st-custom-button data-network=facebook><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/facebook-white.svg>
<span class=st-label>Facebook</span></li><li class=st-custom-button data-network=sharethis><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/sharethis-white.svg>
<span class=st-label>Others</span></li></ul></li><li onclick="location.href='\/nebula-website\/en\/posts'"><img src=/images/blog.png>
<a href=/nebula-website/en/posts>Back to blog home</a></li><li onclick="gtag('event','Link Click',{event_category:'Engagement',event_label:'RSS via blogbody'});window.open('https:\/\/nebula-graph.io/en/posts/index.xml');"><img src=/images/rss.png>
<a href=javascript:void(0);>RSS</a></li></ul><div id=discourse-comments></div></section><div class=single-side-bar><div class=tags-block><h3><img src=/img/LabelTagIcon.png>Tags</h3><ul class=blog-tags><li class=col-md-12><a href=/nebula-website/en/posts class=active>all</a></li><li><a href=/nebula-website/en/tags/architecture>architecture</a></li><li><a href=/nebula-website/en/tags/community>community</a></li><li><a href=/nebula-website/en/tags/deployment>deployment</a></li><li><a href=/nebula-website/en/tags/dev-log class=active>dev-log</a></li><li><a href=/nebula-website/en/tags/features class=active>features</a></li><li><a href=/nebula-website/en/tags/graph-database>graph-database</a></li><li><a href=/nebula-website/en/tags/performance>performance</a></li><li><a href=/nebula-website/en/tags/query-language>query-language</a></li><li><a href=/nebula-website/en/tags/release-notes>release-notes</a></li><li><a href=/nebula-website/en/tags/system-testing>system-testing</a></li><li><a href=/nebula-website/en/tags/tools>tools</a></li><li><a href=/nebula-website/en/tags/use-cases>use-cases</a></li></ul></div><div class=blog-anchors id=J_Anchor><h3>Contents</h3><nav id=TableOfContents><ul><li><a href=#strong-data-consistency-explained>Strong Data Consistency Explained</a></li><li><a href=#linearizability-verification-with-jepsen>Linearizability Verification with Jepsen</a></li><li><a href=#data-consistency-issues-found-with-jepsen-test>Data Consistency Issues Found with Jepsen Test</a><ul><li><a href=#data-consistency-example-1-stale-value-returned-for-read-requests>Data consistency example 1: Stale value returned for read requests </a></li><li><a href=#data-consistency-example-2-leader-ensures-itself-as-a-leader>Data consistency example 2: Leader ensures itself as a leader</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#you-might-also-like>You might also like</a></li></ul></nav></div></div></div><img onclick="location.href='#top'" class=go-ahead src=/images/up.png></div><footer class="container-fluid foot-wrap" name=contact_us><div class=container><div class=row><div class="row-content col-lg-4 col-sm-4 col-xs-4"><h3>Community</h3><ul><li><img src=/img/github.png>
<a href=https://github.com/vesoft-inc/nebula target=_blank>GitHub</a></li><li><img src=/img/forum.png>
<a href=https://discuss.nebula-graph.io/ target=_blank>Forum</a></li><li><img src=/img/slack.png>
<a href=https://join.slack.com/t/nebulagraph/shared_invite/enQtNjIzMjQ5MzE2OTQ2LTM0MjY0MWFlODg3ZTNjMjg3YWU5ZGY2NDM5MDhmOGU2OWI5ZWZjZDUwNTExMGIxZTk2ZmQxY2Q2MzM1OWJhMmY# target=_blank>Slack</a></li></ul></div><div class="row-content col-lg-4 col-sm-4 col-xs-4"><h3>Follow Us</h3><ul><li><img src=/img/twitter.png>
<a href=https://twitter.com/NebulaGraph title=Twitter data-toggle=modal target=_blank data-target>Twitter</a></li><li><img src=/img/linkedin.png>
<a href=https://www.linkedin.com/company/vesoft-nebula-graph/ title=LinkedIn data-toggle=modal target=_blank data-target>LinkedIn</a></li><li><img src=/img/youtube.png>
<a href=https://www.youtube.com/channel/UC73V8q795eSEMxDX4Pvdwmw title=YouTube data-toggle=modal target=_blank data-target>YouTube</a></li><li><img src=/img/facebook.png>
<a href=https://www.facebook.com/NebulaGraph/ title=FaceBook data-toggle=modal target=_blank data-target>FaceBook</a></li><li><img src=/img/weibo.png>
<a href=https://weibo.com/nebulagraph title=WeiBo data-toggle=modal target=_blank data-target>WeiBo</a></li><li><img src=/img/gongzhonghao.png>
<a href title="Official Accounts" data-toggle=modal target=_blank data-target=#myGongzhonghaoModal>Official Accounts</a></li></ul></div><div class="contactus row-content col-lg-4 col-sm-4 col-xs-4"><h3>Contact Us</h3><ul><li><img src=/img/iphone.png>
<a href data-toggle=modal target=_blank data-target>(+86) 0571-28120658</a></li><li><img src=/img/email.png>
<a href=mailto:info@vesoft.com data-toggle=modal target=_blank data-target>info@vesoft.com</a></li><li><img src=/img/weixin.png>
<a href data-toggle=modal target=_blank data-target=#myModal>WeChat</a></li></ul></div></div></div><p align=left style=font-size:16px><img src=/images/VEsoft.png style=margin-right:10px> Copyright &copy;2020 VESoft Inc</p><div class="modal fade" id=myGongzhonghaoModal tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true><div class=modal-dialog><div class=modal-content><div class="modal-body wechat"><img src=/images/gonggonghaoCODE.jpg></div><div class=modal-footer><button type=button class="btn btn-default" data-dismiss=modal>close</button></div></div></div></div><div class="modal fade" id=myModal tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true><div class=modal-dialog><div class=modal-content><div class="modal-body wechat"><img src=/images/wechat.png></div><div class=modal-footer><button type=button class="btn btn-default" data-dismiss=modal>close</button></div></div></div></div></footer></main><div id=J_Star_Popup class=nebula-star-popup></div><script src=/nebula-website/js/jquery.js></script><script src=/nebula-website/js/bootstrap.min.js></script><script src=/nebula-website/js/jquery.easing.min.js></script><script src=/nebula-website/js/jquery.fittext.js></script><script src=/nebula-website/js/wow.min.js></script><script type=text/javascript src="https://platform-api.sharethis.com/js/sharethis.js#property=5e7c2cc315c7990012ae38bc&product=inline-share-buttons" async></script><script src=/nebula-website/js/creative.js></script><script async defer src=https://buttons.github.io/buttons.js></script><script src=/nebula-website/js/init.js></script><script type=text/javascript>DiscourseEmbed={discourseUrl:'https://discuss.nebula-graph.io/',discourseEmbedUrl:"\/nebula-website\/en\/posts\/detect-data-consistency-issues-in-raft-implementing-with-jepsen\/"};(function(){var d=document.createElement('script');d.type='text/javascript';d.async=true;d.src=DiscourseEmbed.discourseUrl+'javascripts/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(d);})();</script><script src=/nebula-website/js/anchor.js></script></body></html><script>if(!sessionStorage.getItem("popupIsRemove")){$("#top").css("padding-top","98px")}</script>