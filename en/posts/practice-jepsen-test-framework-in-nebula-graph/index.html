<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Nebula Graph"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@NebulaGraph"><meta name=twitter:creator content="@NebulaGraph"><meta name=twitter:domain content="nebula-graph.io"><meta name=twitter:title content="Practice Jepsen Test Framework in Nebula Graph"><meta property="twitter:title" content="Practice Jepsen Test Framework in Nebula Graph"><meta name=twitter:description content="This article introduces how Nebula Graph, an open-source distributed graph database, uses Jepsen test framework to ensure system data consistency."><meta name=og:description content="This article introduces how Nebula Graph, an open-source distributed graph database, uses Jepsen test framework to ensure system data consistency."><meta name=twitter:image content="/nebula-website/en/posts/practice-jepsen-test-framework-in-nebula-graph/jepsen_huf951ff32dc63e564912aa6668b0317ae_948129_600x0_resize_box_2.png"><meta name=og:image content="/nebula-website/en/posts/practice-jepsen-test-framework-in-nebula-graph/jepsen_huf951ff32dc63e564912aa6668b0317ae_948129_600x0_resize_box_2.png"><meta name=description content="This article introduces how Nebula Graph, an open-source distributed graph database, uses Jepsen test framework to ensure system data consistency."><meta name=generator content="Hugo 0.65.3"><title>Practice Jepsen Test Framework in Nebula Graph</title><link rel="shortcut icon" href=/nebula-website/favicon.ico><link rel=stylesheet href=/nebula-website/css/bootstrap.min.css type=text/css><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic" rel=stylesheet type=text/css><link rel=stylesheet href=/nebula-website/font-awesome/css/font-awesome.min.css type=text/css><link rel=stylesheet href=/nebula-website/css/creative.css type=text/css><link rel=stylesheet href=/nebula-website/css/modals.css type=text/css><link rel=stylesheet href=/nebula-website/css/animate.min.css type=text/css><link rel=stylesheet href=/nebula-website/css/custom/index.css type=text/css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/nebula-website/js/jquery.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-60523578-5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-60523578-5');</script></head><body id=page-top><nav id=mainNav class="navbar navbar-default navbar-fixed-top"><div class=container-fluid><div class=navbar-header><div class=github-star><a class=github-button href=https://github.com/vesoft-inc/nebula data-icon=octicon-star data-show-count=true aria-label="Star vesoft-inc/nebula on GitHub">Star</a></div><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class="navbar-brand page-scroll" href=/></a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav" id=nav><li class=github-star id=github-star><a class=github-button href=https://github.com/vesoft-inc/nebula data-size=large data-show-count=true aria-label="Star vesoft-inc/nebula on GitHub">Star</a></li><li><a href=https://docs.nebula-graph.io/ target=_blank>Docs</a></li><li><a href=/en/posts target>Blog</a></li><li><a href=https://discuss.nebula-graph.io/ target=_blank>Forum</a></li><li><a href=#contact_us target onclick=contactUsClick()>Contact Us</a></li><li class="dropdown navbar-right"><a class=dropdown-toggle data-toggle=dropdown href=# role=button aria-haspopup=true aria-expanded=false><img src=/images/language120x120.png>
<span class=caret></span></a><ul class=dropdown-menu><li class=nav-item><a class=dropdown-item href=/en target>English</a></li><li class=nav-item><a class=dropdown-item href=/cn target>中文</a></li></ul></li><li id=navbar-right><a href=https://github.com/vesoft-inc/nebula-web-docker target=_blank>Nebula Studio</a></li></ul></div></div></nav><script>function contactUsClick(){$('html,body').animate({scrollTop:document.documentElement.scrollHeight},800)
return false;}</script><main id=top class=blog-detail><div class=wrapper><div class=inner><section class=blog-content><h1>Practice Jepsen Test Framework in Nebula Graph</h1><div class=blog-metas><div class=meta><img src=/images/writer.png width=16px height=16px>
<span>Fuyao Wang</span></div><div class=meta><img src=/images/calendar.png width=16px height=16px>
<span>2020-01-14</span></div><div class="tags meta"><img src=/images/tag.png width=16px height=16px>
<a href=/nebula-website/en//tags/system-testing>system-testing</a></div></div><p>​<img src=https://user-images.githubusercontent.com/56643819/72118703-f6f65c00-338c-11ea-8fa2-1ecaa5b49bd5.png alt=product></p><p>This article introduces how Nebula Graph uses Jepsen test framework to ensure system linearizability.</p><h2 id=why-jepsen>Why Jepsen?</h2><p>Linearizability here specifically means consistency in the CAP theory. In Nebula Graph, we gurantee strong data consistency in our key-value store.</p><p>So under such a consistency policy, we need to make sure:</p><ul><li>A read happens BEFORE a write operation ends must read the previous write</li><li>A read happens AFTER a write operation ends must read the current write     </li></ul><p>Strong data consistency relies on a solid chaos testing plan which can affect a distributed system in many unplanned ways, which in turn helps uncover corner cases that are hard to detect in development.</p><p>This is how Jepsen comes into play.</p><h2 id=what-is-jepsen>What is Jepsen?</h2><p>Jepsen is an open source software library for system testing. It is an effort to improve the saftey of distributed databases, queues, consensus systems, etc.</p><p>Jepsen&rsquo;s author Kyle Kingsbury writes the test framework with Clojure, a functional programming language. He has then performed linearizability tests on some well known distributed systems and databases.</p><p>Currently Jepsen is still active on GitHub and it has become the actual benchmark for distributed systems.</p><h2 id=jepsen-test-process>Jepsen Test Process</h2><p>Below is a chart depicting the Jepsen test process:</p><p><img src=https://user-images.githubusercontent.com/56643819/72578065-e0617f00-390f-11ea-84e7-0c945f7ddca9.png alt=process></p><p>By default there are six containers in the cluster, one of which is the control node and the other five are database nodes (the nodes are named n1 - n5 respectively).
As soon as the test starts, the control node will create a group of worker threads, each contains its own client, to access the database nodes simultaneously via the SSH protocol. The generator tells the client what operations it should perform against the system while the nemesis tells the client what fault the client should inject to the system. </p><p>The beginning, ending, and results of each operation will be documented in Jepsen&rsquo;s history folder.  </p><p>When the test ends, the checker will analyze the history accuracy to verify if the results are linearizable. For the checker, you can use either the built-in validation model provided by <a href=https://github.com/jepsen-io/knossos>Jepsen knossos</a>, or you can define custom model per your own business requirements.</p><h2 id=things-to-consider-before-the-test>Things to Consider Before the Test</h2><p>To make sure the Jepsen test runs smoothly, please be sure to complete the following configuration before you start the test:</p><ol><li><strong>Define operations in the DB API: download, install, start, and end</strong></li></ol><p>You may delete the database log files when the test ends. Or you can specify a location for the log files and Jepsen will copy them to its own log folder for later analysis.</p><ol start=2><li><strong>Choose a client</strong></li></ol><p>Be sure to have a client to access your database. The client can be either Clojure based such as etcd verschlimmbesserung, or JDBC and so forth. Then you need to define the client API to tell Jepsen what operations can be performed against your database.</p><ol start=3><li><strong>Select the test model in Checker</strong></li></ol><p>For example, Jepsen will generate a chart for latency and the entire test process for performance test (checker/perf) and an html page containing timestamps of all operations for timeline test (timeline/html).</p><ol start=4><li><strong>Define failure types</strong></li></ol><p>Specify the types of faults you want to inject to the system in the Nemesis component. Some common ones include partition-random-halves and kill-node.</p><ol start=5><li><strong>Configure worker thread paramters</strong></li></ol><p>Configure the operations within the worker thread in the generator process, as well as the time interval of each operation and each fault injection.   </p><h2 id=running-jepsen-test-on-nebula-graph>Running Jepsen Test on Nebula Graph</h2><p>Nebula Graph has three components: meta layer, graph layer, and storage layer. The three layers work as a whole for Nebula Graph service to run normally.</p><p>The Jepsen test is mainly on the storage layer.  </p><p><img src=https://user-images.githubusercontent.com/56643819/72118779-358c1680-338d-11ea-84ea-2ef07faec18d.png alt=architecture></p><p>During the test against the KV storage API, we have built an eight-container cluster:</p><ul><li>One Jepsen control node</li><li>One meta node</li><li>One graph node</li><li>Five storage nodes</li></ul><p>The cluster is built in Docker and started by Docker-compose. Bear in mind the following two things:</p><ol><li>There should be a subnet within the cluster so that the nodes can communicate with each other.</li><li>Install SSH service and enable passwordless login to the five storage nodes for the Jepsen control node.  </li></ol><p>We have generated a jar package with the Java client and added it to the Clojure dependencies. Then the client can perform operations (put, get, cas, etc.) against the database. In addition, auto retry logic has been added to the Java client so that proper retry mechnism is enabled to make sure the operations have been successfully completed. 
Nebula-Jepsen, the test program developed by Nebula Graph, has three test models and three common chaos injections.</p><h3 id=jepsen-test-models>Jepsen Test Models</h3><h4 id=single-register>single-register</h4><p>A single-register stores only the value of one key. While the test program reads and writes the database simultaneously, each sucessful write changes the value stored in the register.</p><p>Then compare the read value from the database with the value in the register to see if they are consistent, which can validate whether the system is linearizable.</p><p>Since it&rsquo;s a one-key register, the key is the same during the test and the value of the key is randomly generated upon operations.  </p><h4 id=multi-register>multi-register</h4><p>A multi-register however stores values of multiple keys. The validation process is the same as single-register, only that the keys are also randomly generated in multi-register.</p><p>Below is a sample of read and write operations during the test:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#ae81ff>4</span>       :invoke :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>9</span> 1<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>4</span>       :ok     :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>9</span> 1<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>3</span>       :invoke :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>5</span> nil<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>3</span>       :ok     :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>5</span> 3<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :invoke :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>7</span> nil<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :ok     :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>7</span> 2<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :invoke :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>7</span> 1<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :ok     :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>7</span> 1<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>1</span>       :invoke :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>1</span> nil<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>1</span>       :ok     :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>1</span> 4<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :invoke :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>8</span> nil<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :ok     :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>8</span> 3<span style=color:#f92672>]]</span>
:nemesis        :info   :start  nil
:nemesis        :info   :start  <span style=color:#f92672>[</span>:isolated <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;n5&#34;</span> <span style=color:#75715e>#{&#34;n2&#34; &#34;n1&#34; &#34;n4&#34; &#34;n3&#34;}, &#34;n2&#34; #{&#34;n5&#34;}, &#34;n1&#34; #{&#34;n5&#34;}, &#34;n4&#34; #{&#34;n5&#34;}, &#34;n3&#34; #{&#34;n5&#34;}}]</span>
<span style=color:#ae81ff>1</span>       :invoke :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>4</span> 2<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>1</span>       :ok     :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>4</span> 2<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>2</span>       :invoke :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>5</span> nil<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>3</span>       :invoke :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>1</span> 2<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>2</span>       :ok     :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>5</span> 3<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>3</span>       :ok     :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>1</span> 2<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :invoke :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>4</span> nil<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>0</span>       :ok     :read   <span style=color:#f92672>[[</span>:r <span style=color:#ae81ff>4</span> 2<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>1</span>       :invoke :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>6</span> 4<span style=color:#f92672>]]</span>
<span style=color:#ae81ff>1</span>       :ok     :write  <span style=color:#f92672>[[</span>:w <span style=color:#ae81ff>6</span> 4<span style=color:#f92672>]]</span>
</code></pre></div><p>In the sample above, the number on the left indicates the worker (i.e. thread No.) which performs the operation. Every time an operation is initiated, the record is tagged as invoke and the column right next to it specifies if it&rsquo;s a read or a write. The info within the square brackets are the details of the operation.
Let&rsquo;s see some examples:</p><ul><li><code>:invoke :read   [[:r 1 nil]]</code>This row records a read operation has been initiated intending to read the value of key 1. Since the operation has just started, the value of the key is unknown, hence &ldquo;nil&rdquo; next to 1.</li><li><code>:ok     :read   [[:r 1 4]]</code> This row records a successful read operation and the value of key 1 is 4.</li></ul><p>You may also notice a nemesis operation in the sample above.</p><ul><li><code>:nemesis   :info   :start  nil</code> This row records the beginning of a nemesis operation.  The next record indicates that nemesis intends to isolate n5 from the cluster so that it&rsquo;s unable to communicate with other nodes within the cluster.</li></ul><h4 id=cas-register>cas-register</h4><p>Besides the read and write, there&rsquo;s a cas-register to validate cas (compare-and-set) operations.</p><p>Below is a sample code from the test:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>0		:invoke	:read		nil
0		:ok			:read		<span style=color:#ae81ff>0</span>
1		:invoke	:cas		<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span> 2<span style=color:#f92672>]</span>
1		:ok			:cas		<span style=color:#f92672>[</span><span style=color:#ae81ff>0</span> 2<span style=color:#f92672>]</span>
4		:invoke	:read		nil
4		:ok			:read		<span style=color:#ae81ff>2</span>
0		:invoke	:read		nil
0		:ok			:read		<span style=color:#ae81ff>2</span>
2		:invoke	:write	<span style=color:#ae81ff>0</span>
2		:ok			:write	<span style=color:#ae81ff>0</span>
3		:invoke	:cas		<span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> 2<span style=color:#f92672>]</span>
:nemesis		:info		:start	nil
0		:invoke	:read		nil
0		:ok			:read		<span style=color:#ae81ff>0</span>
1		:invoke	:cas		<span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> 3<span style=color:#f92672>]</span>
:nemesis		:info		:start	<span style=color:#f92672>{</span><span style=color:#e6db74>&#34;n1&#34;</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>}</span>
3		:fail		:cas		<span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> 2<span style=color:#f92672>]</span>
1		:fail		:cas		<span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> 3<span style=color:#f92672>]</span>
4		:invoke	:read		nil
4		:ok			:read		<span style=color:#ae81ff>0</span>
</code></pre></div><p>Just like the single-register test, the key remains the same during the entire cas operation test process. 
Let&rsquo;s take a look at some examples:</p><ul><li><code>:invoke :read  nil</code> This row records the initiation of a read operation. Since it&rsquo;s just the beginning, the result is nil.</li><li><code>:ok   :read  0</code> This row records a successful read operation. The value returned is 0.</li><li><code>:invoke :cas  [1 2]</code> This row records the initiation of cas operation, i.e. update the value to 2 if the read result is 1. </li></ul><h3 id=introducing-failures-in-jepsen>Introducing Failures in Jepsen</h3><p>Below are the three types of failures Nebula Graph has injected to the cluster for chaos testing purpose.</p><h4 id=kill-node>kill-node</h4><p>The control node of Jepsen will randomly kill a certain database service on a node several times during the entire test. When a node is killed, the available nodes decreased by one in the cluster. After a certain time, the database service of the node is started and the node will rejoin the cluster.</p><h4 id=partition-random-node>partition-random-node</h4><p>Jepsen will randomly isolate a node from others during the test, so that there is no communication between this node and other nodes. Then Jepsen will repair this network isolation after a certain time to restore the cluster to its original state.</p><h4 id=partition-random-halves>partition-random-halves</h4><p>In this common network partition, the Jepsen control node randomly cuts the five databse nodes into two parts, one of which has two nodes and the other has three. Communication will be resumed after a certain period of time as shown below.</p><p><img src=https://user-images.githubusercontent.com/56643819/72118867-869c0a80-338d-11ea-878d-15ea79811a8b.png alt=partition></p><h2 id=test-results>Test Results</h2><p>Jepsen will analyze the test results according to the requirements and get the results of this test. From the following output of the console, we can see the test is passed.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>2020-01-08 03:24:51,742<span style=color:#f92672>{</span>GMT<span style=color:#f92672>}</span>	INFO	<span style=color:#f92672>[</span>jepsen test runner<span style=color:#f92672>]</span> jepsen.core: <span style=color:#f92672>{</span>:timeline <span style=color:#f92672>{</span>:valid? true<span style=color:#f92672>}</span>,
 :linear
 <span style=color:#f92672>{</span>:valid? true,
  :configs
  <span style=color:#f92672>({</span>:model <span style=color:#f92672>{</span>:value 0<span style=color:#f92672>}</span>,
    :last-op
    <span style=color:#f92672>{</span>:process 0,
     :type :ok,
     :f :write,
     :value 0,
     :index 597,
     :time 60143184600<span style=color:#f92672>}</span>,
    :pending <span style=color:#f92672>[]})</span>,
  :analyzer :linear,
  :final-paths <span style=color:#f92672>()}</span>,
 :valid? true<span style=color:#f92672>}</span>


Everything looks good! ヽ<span style=color:#f92672>(</span>‘ー<span style=color:#e6db74>`</span><span style=color:#f92672>)</span>ノ
</code></pre></div><h3 id=auto-generated-timelinehtml-file>Auto-Generated timeline.html File</h3><p>After the test is completed, you will get an auto-generated timeline.html file. The follow picture shows part of this file.</p><p><img src=https://user-images.githubusercontent.com/56643819/72118901-a9c6ba00-338d-11ea-9efa-045ed1914608.png alt=timeline></p><p>The above picture shows the timeline of operations. Each execution block has the corresponding execution information.Jepsen verifies the linearizability based on this operation order. This also acts as Jepsen&rsquo;s core. We can also track faults with the HTML file.</p><h3 id=performance-analysis-generated-with-jepsen>Performance Analysis Generated With Jepsen</h3><p>Following are some performance analysis charts generated with Jepsen. This project name is basic test, please note that your project name may be different.</p><p><img src=https://user-images.githubusercontent.com/56643819/72118934-c5ca5b80-338d-11ea-9603-ca65a36baf1b.png alt=latency></p><p>We can see the read and write latency in this chart. The above grey area incites the timing of fault injection. In this test we injected random killing node.</p><p><img src=https://user-images.githubusercontent.com/56643819/72118989-e5fa1a80-338d-11ea-8f81-af98870621ca.png alt=rate></p><p>This chart shows the success rate of read and write. We can see the highlighted bottom red area is where failures occurred. This is because the control node stopped the partition leader&rsquo;s nebula service when killing a node. The cluster needs to re-elect at this time. When new leader is selected, the read and write are restored to normal.</p><h2 id=conclusion>Conclusion</h2><p>Jepsen has some short comings, such as the test can&rsquo;t run for a long time, because a large amount of data will cause out of memory during the verification phrase.</p><p>However, in actual scenarios, many bugs require long-term stress tests and fault simulations to discover, and the stability of the system also requires long-term running to be verified. Meanwhile, when testing Nebula Graph with Jepsen, we also found some bugs that we&rsquo;ve never seen before, some of which may never happen in use.</p><p>Currently, we are using Jepsen to test Nebula Graph on daily basis. We release the newly-updated code to the Docker Hub every day to perform continuous tests of the latest images with the Nebula-Jepsen.</p><h2 id=references>References</h2><ul><li>Jepsen HomePage: <a href=https://jepsen.io/>https://jepsen.io/</a></li><li>Jepsen GitHub: <a href=https://github.com/jepsen-io/jepsen>https://github.com/jepsen-io/jepsen</a></li><li><a href=http://thesecretlivesofdata.com/raft/>Raft Understandable Distributed Consensus</a></li><li><a href=https://raft.github.io/>The Raft Consensus Algorithm</a></li><li>Nebula Graph GitHub: <a href=https://github.com/vesoft-inc/nebula>https://github.com/vesoft-inc/nebula</a></li></ul><blockquote class=star-ads><span>Do you like this post? If yes, just give me a</span>
<span class="glyphicon glyphicon-star"></span><span>star:</span>
<a href=https://github.com/vesoft-inc/nebula>https://github.com/vesoft-inc/nebula</a></blockquote><ul class=blog-footer><li><img src=/images/tag.png>
<a href=/nebula-website/en/tags/System-Testing>System-Testing</a></li><li class="nebula-share st-btn"><img src=/images/share.png>
<span>Share Post</span><ul class=blog-footer-share-links><li class=st-custom-button data-network=twitter><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/twitter-white.svg>
<span class=st-label>Twitter</span></li><li class=st-custom-button data-network=linkedin><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/linkedin-white.svg>
<span class=st-label>Linkedin</span></li><li class=st-custom-button data-network=facebook><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/facebook-white.svg>
<span class=st-label>Facebook</span></li><li class=st-custom-button data-network=sharethis><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/sharethis-white.svg>
<span class=st-label>Others</span></li></ul></li><li onclick="location.href='\/nebula-website\/en\/posts'"><img src=/images/blog.png>
<a href=/nebula-website/en/posts>Back to blog home</a></li><li onclick="location.href='https:\/\/nebula-graph.io/en/posts/index.xml'"><img src=/images/rss.png>
<a onclick="window.open('https:\/\/nebula-graph.io/en/posts/index.xml')" href>RSS</a></li></ul><div id=discourse-comments></div></section><div class=single-side-bar><div class=tags-block><h3 class="glyphicon glyphicon-tag">Tags</h3><ul class=blog-tags><li class=col-md-12><a href=/nebula-website/en/posts class=active>All</a></li><li><a href=/nebula-website/en/tags/architecture>architecture</a></li><li><a href=/nebula-website/en/tags/community>community</a></li><li><a href=/nebula-website/en/tags/deployment>deployment</a></li><li><a href=/nebula-website/en/tags/dev-log>dev-log</a></li><li><a href=/nebula-website/en/tags/features>features</a></li><li><a href=/nebula-website/en/tags/graph-database>graph-database</a></li><li><a href=/nebula-website/en/tags/graph-query-language>graph-query-language</a></li><li><a href=/nebula-website/en/tags/performance>performance</a></li><li><a href=/nebula-website/en/tags/release-notes>release-notes</a></li><li><a href=/nebula-website/en/tags/system-testing>system-testing</a></li><li><a href=/nebula-website/en/tags/tools>tools</a></li><li><a href=/nebula-website/en/tags/use-cases>use-cases</a></li></ul></div><div id=blog-carousel class="carousel slide" data-ride=carousel><ol class=carousel-indicators><li data-target=#blog-carousel data-slide-to=0 class=active></li><li data-target=#blog-carousel data-slide-to=1></li></ol><div class=carousel-inner role=listbox><div class="item active" onclick="location.href='\/en\/posts\/clean-stale-data-with-ttl-in-nebula-graph_\/'"><img src=https://user-images.githubusercontent.com/38887077/77512987-09256800-6eaf-11ea-9b41-e8b87ab51fe8.png alt="Automatically Cleans" width=220px height=150px><div class=carousel-caption>Automatically Cleans</div></div><div class=item onclick="location.href='\/en\/posts\/github-action-automating-project-process\/'"><img src=https://user-images.githubusercontent.com/38887077/76831941-482a3c80-6863-11ea-9795-009eaa50fc0e.png alt="Automating Your Project Processes with Github Actions" width=220px height=150px><div class=carousel-caption>Automating Your Project Processes with Github Actions</div></div></div><a class="left carousel-control" href=#blog-carousel role=button data-slide=prev><span class="glyphicon glyphicon-chevron-left" aria-hidden=true></span><span class=sr-only>Previous</span></a>
<a class="right carousel-control" href=#blog-carousel role=button data-slide=next><span class="glyphicon glyphicon-chevron-right" aria-hidden=true></span><span class=sr-only>Next</span></a></div><div class=blog-anchors><h3>Contents</h3><nav id=TableOfContents><ul><li><a href=#why-jepsen>Why Jepsen?</a></li><li><a href=#what-is-jepsen>What is Jepsen?</a></li><li><a href=#jepsen-test-process>Jepsen Test Process</a></li><li><a href=#things-to-consider-before-the-test>Things to Consider Before the Test</a></li><li><a href=#running-jepsen-test-on-nebula-graph>Running Jepsen Test on Nebula Graph</a><ul><li><a href=#jepsen-test-models>Jepsen Test Models</a></li><li><a href=#introducing-failures-in-jepsen>Introducing Failures in Jepsen</a></li></ul></li><li><a href=#test-results>Test Results</a><ul><li><a href=#auto-generated-timelinehtml-file>Auto-Generated timeline.html File</a></li><li><a href=#performance-analysis-generated-with-jepsen>Performance Analysis Generated With Jepsen</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ul></nav></div><div class=social-share><h3>Share Post</h3><div class=nebula-share-buttons><div class="st-custom-button st-remove-label" data-network=twitter><img alt="twitter-white sharing button" src=https://platform-cdn.sharethis.com/img/twitter-white.svg></div><div class="st-custom-button st-remove-label" data-network=linkedin><img alt="linkedin-white sharing button" src=https://platform-cdn.sharethis.com/img/linkedin-white.svg></div><div class="st-custom-button st-remove-label" data-network=facebook><img alt="facebook-white sharing button" src=https://platform-cdn.sharethis.com/img/facebook-white.svg></div><div class="st-custom-button st-remove-label" data-network=hackernews><img alt="hackernews-white sharing button" src=https://platform-cdn.sharethis.com/img/hackernews-white.svg></div><div class="st-custom-button st-remove-label" data-network=reddit><img alt="reddit-white sharing button" src=https://platform-cdn.sharethis.com/img/reddit-white.svg></div><div class="st-custom-button st-remove-label" data-network=sharethis><img alt="reddit-white sharing button" src=https://platform-cdn.sharethis.com/img/sharethis-white.svg></div></div></div></div></div><img onclick="location.href='#top'" class=go-ahead src=/images/up.png></div><footer class="container-fluid foot-wrap" name=contact_us><div class=container><p align=center class=statement>Nebula Graph will respect your data privacy per our Privacy Policy</p><div class=row><div class="row-content col-lg-4 col-sm-4 col-xs-4"><h3>Community</h3><ul><li><img src=/img/github.png>
<a href=https://github.com/vesoft-inc/nebula target=_blank>GitHub</a></li><li><img src=/img/forum.png>
<a href=https://discuss.nebula-graph.io/ target=_blank>Forum</a></li><li><img src=/img/slack.png>
<a href=https://join.slack.com/t/nebulagraph/shared_invite/enQtNjIzMjQ5MzE2OTQ2LTM0MjY0MWFlODg3ZTNjMjg3YWU5ZGY2NDM5MDhmOGU2OWI5ZWZjZDUwNTExMGIxZTk2ZmQxY2Q2MzM1OWJhMmY# target=_blank>Slack</a></li></ul></div><div class="row-content col-lg-4 col-sm-4 col-xs-4"><h3>Follow Us</h3><ul><li><img src=/img/twitter.png>
<a href=https://twitter.com/NebulaGraph title=Twitter data-toggle=modal target=_blank data-target>Twitter</a></li><li><img src=/img/weibo.png>
<a href=https://weibo.com/nebulagraph title=WeiBo data-toggle=modal target=_blank data-target>WeiBo</a></li><li><img src=/img/linkedin.png>
<a href=https://www.linkedin.com/company/vesoft-nebula-graph/ title=LinkedIn data-toggle=modal target=_blank data-target>LinkedIn</a></li><li><img src=/img/youtube.png>
<a href=https://www.youtube.com/channel/UC73V8q795eSEMxDX4Pvdwmw title=YouTube data-toggle=modal target=_blank data-target>YouTube</a></li><li><img src=/img/facebook.png>
<a href=https://www.facebook.com/NebulaGraph/ title=FaceBook data-toggle=modal target=_blank data-target>FaceBook</a></li><li><img src=/img/gongzhonghao.png>
<a href title="Official Accounts" data-toggle=modal target=_blank data-target=#myGongzhonghaoModal>Official Accounts</a></li></ul></div><div class="contactus row-content col-lg-4 col-sm-4 col-xs-4"><h3>Contact Us</h3><ul><li><img src=/img/iphone.png>
<a href data-toggle=modal target=_blank data-target>(+86) 0571-28120658</a></li><li><img src=/img/email.png>
<a href=mailto:info@vesoft.com data-toggle=modal target=_blank data-target>info@vesoft.com</a></li><li><img src=/img/weixin.png>
<a href data-toggle=modal target=_blank data-target=#myModal>WeChat</a></li></ul></div></div></div><p align=left style=font-size:16px><img src=/images/VEsoft.png style=margin-right:10px> Copyright &copy;2020 VESoft Inc</p><div class="modal fade" id=myGongzhonghaoModal tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true><div class=modal-dialog><div class=modal-content><div class="modal-body wechat"><img src=/images/gonggonghaoCODE.jpg></div><div class=modal-footer><button type=button class="btn btn-default" data-dismiss=modal>close</button></div></div></div></div><div class="modal fade" id=myModal tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true><div class=modal-dialog><div class=modal-content><div class="modal-body wechat"><img src=/images/wechat.png></div><div class=modal-footer><button type=button class="btn btn-default" data-dismiss=modal>close</button></div></div></div></div></footer></main><div id=J-star-popup class=nebula-star-popup></div><script src=/nebula-website/js/jquery.js></script><script src=/nebula-website/js/bootstrap.min.js></script><script src=/nebula-website/js/jquery.easing.min.js></script><script src=/nebula-website/js/jquery.fittext.js></script><script src=/nebula-website/js/wow.min.js></script><script type=text/javascript src="https://platform-api.sharethis.com/js/sharethis.js#property=5e7c2cc315c7990012ae38bc&product=inline-share-buttons" async></script><script src=/nebula-website/js/creative.js></script><script async defer src=https://buttons.github.io/buttons.js></script><script src=/nebula-website/js/init.js></script><script type=text/javascript>DiscourseEmbed={discourseUrl:'https://discuss.nebula-graph.io/',discourseEmbedUrl:"\/nebula-website\/en\/posts\/practice-jepsen-test-framework-in-nebula-graph\/"};(function(){var d=document.createElement('script');d.type='text/javascript';d.async=true;d.src=DiscourseEmbed.discourseUrl+'javascripts/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(d);})();</script></body></html>